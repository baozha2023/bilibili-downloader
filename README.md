# Bilibili Downloader

[![License](https://img.shields.io/badge/license-MIT-blue.svg)](LICENSE)
[![Python](https://img.shields.io/badge/python-3.8+-blue.svg)](https://www.python.org/downloads/)

一个简洁、易用的B站视频下载工具，支持图形界面(GUI)和命令行(CLI)操作。

![Screenshot](resource/screenshot.png)

## ✨ 功能特性

* **高清下载**：支持下载1080P、4K等高清视频（需登录大会员账号）。
* **视频合并**：自动合并视频流和音频流，输出完整的MP4文件。
* **断点续传**：支持网络中断后的断点续传。
* **热门视频**：查看并下载B站热门视频。
* **去水印**：(实验性) 支持去除视频右上角水印。
* **多平台**：支持Windows、Linux和macOS（需自行配置ffmpeg）。
* **双模式**：提供直观的GUI界面和高效的命令行模式。
* **模块化设计**：v2.0 采用全新的模块化架构，运行更稳定，维护更方便。

## 📦 安装与运行

### 依赖环境

* Python 3.8 或更高版本
* ffmpeg (用于视频合并和处理)

### 安装步骤

1. 克隆或下载本项目代码。
2. 安装Python依赖：
   ```bash
   pip install -r requirements.txt
   ```
3. 确保 `ffmpeg` 可用：
    * Windows: 将 `ffmpeg.exe` 放入项目根目录下的 `ffmpeg/` 文件夹中，或添加到系统环境变量 PATH 中。
    * Linux/macOS: 使用包管理器安装 (e.g., `apt install ffmpeg` or `brew install ffmpeg`)。

### 运行程序

**启动图形界面 (GUI):**

```bash
python main.py
```

**使用命令行 (CLI):**

```bash
# 下载指定视频
python main.py -d BV1xx411c7mD

# 爬取热门视频
python main.py -p --pages 3
```

## 🛠️ 开发构建

本项目使用 PyInstaller 进行打包。

```bash
python build.py
```

构建完成后，可执行文件将位于 `dist/bilibili_downloader/` 目录。

## 📝 版本历史

### v5.7

* **修复**: 用户查询中使用CRC32反查UID后未使用UID查询的Bug。
* **修复**: 视频下载历史记录存储BV号而不是网址。
* **优化**: 用户查询列表签名仅展示首行，详情展示完整；修复头像不显示问题。
* **优化**: 用户查询支持重试机制，从设置中获取重试次数和间隔。
* **日志**: 用户查询添加详细日志。
* **更新**: 版本号更新至 v5.7。

### v5.6.7

* **优化**:版本管理代码重构，提升代码内聚性与低耦合。
* **优化**:全局代码清理，移除冗余代码，优化复杂逻辑。
* **优化**:代码格式规范化，便于后续维护与升级。
* **更新**:版本号更新至 v5.6.7。

### v5.6.6

* **新增**:版本管理支持选择代码源 (Gitee/GitHub)。
* **新增**:GitHub源支持直接下载编译好的程序，无需本地Python环境。
* **优化**:版本管理界面及逻辑重构。
* **优化**:代码结构清理与性能优化。

### v5.6.5

* **新增**:用户查询支持使用UID、用户名及弹幕哈希(CRC32)反查用户。
* **新增**:用户查询支持双击查看详细信息。
* **优化**:移除用户查询结果的右键菜单。
* **优化**:番剧下载历史记录支持重新下载。
* **优化**:代码结构优化，提升稳定性。

### v5.6.4

* **重构**: 重写版本管理逻辑，自动检测本地Python环境。
* **优化**: 无本地Python环境时不显示版本管理按钮，避免误操作。
* **优化**: 版本切换优先使用用户本地Python环境进行编译。
* **优化**: 自动检测并安装缺失的依赖库，确保编译成功率。
* **优化**: 代码结构优化，提升稳定性。

### v5.6.3

* **修复**: 修复打包后版本管理无法获取版本列表的Bug (集成Git环境)。
* **优化**: 集成Git环境，支持在无Git环境的电脑上运行版本管理。
* **优化**: 核心代码增加详细中文注释，便于阅读和维护。
* **优化**: 代码结构优化，清理冗余代码，提升代码质量。
* **优化**: 版本号统一管理，避免版本号不一致问题。

### v5.6.2

* **修复**: 番剧下载取消后进度条归零，并正确记录已取消状态。
* **优化**: 版本管理界面改为表格展示，显示详细更新日志和日期。
* **修复**: 修复视频分析界面部分图表无法显示的bug。
* **优化**: 代码结构优化，清理冗余代码。

### v5.6.1

* **修复**: 修复扫码登录后未检测到登陆状态的bug。
* **优化**: 将版本管理按钮移动到作者声明旁边，并采用模块化设计。
* **修复**: 修复版本管理按钮不显示的bug。
* **管理**: 新增关于与版本管理独立模块，便于维护。

### v5.6

* **修复**: 修复视频合并中清空列表弹窗缺少确认/取消按钮的问题。
* **优化**: 番剧下载历史记录新增重新下载功能，修复双击修改bug。
* **分析**: 增强视频分析功能，新增性别分布、活跃时间、情感趋势等图表。
* **管理**: 新增版本管理功能，支持版本切换与更新。
* **代码**: 深度重构与优化，提升代码质量。

### v5.5

* **转换**: 增强格式转换功能，新增音频格式提取与转换支持。
* **番剧**: 支持SS号解析下载，新增下载历史重新下载功能。
* **查询**: 新增用户查询模块，支持ID与昵称搜索。
* **分析**: 增强视频分析功能，新增相关视频推荐卡片。
* **优化**: 移除收藏夹右键菜单，优化代码结构，提升稳定性。

### v5.4

* **界面**: 新增B站风格加载进度条，优化窗口放大逻辑。
* **交互**: 支持主界面Tab拖拽排序、隐藏及配置保存。
* **历史**: 增加“已取消”状态记录，我的账号历史记录支持悬停显示封面。
* **分析**: 增强视频分析功能，优化用户体验。
* **优化**: 代码重构，提升稳定性。

### v5.3

* **设置**: 移除自动去水印选项。
* **编辑**: 新增手动去水印功能（支持框选）。
* **历史**: 优化下载失败记录，保留BV号和标题。
* **界面**: 优化窗口最大化时的布局。
* **分析**: 新增评论用户性别分布和活跃时间分布图表。
* **优化**: 代码重构与清理。

### v5.2

* **画质**: 登录后自动调整画质（大会员4K，普通登录1080P）。
* **合并**: 视频合并支持拖拽添加文件。
* **编辑**: 新增视频反转功能。
* **分析**: 优化评论关键词提取，新增表情包分布图表。
* **修复**: 修复番剧下载失败时不记录历史的问题。
* **优化**: 代码重构，移除冗余代码，提升稳定性。

### v5.1

* **收藏**: 优化导出功能，支持仅导出Excel格式，移除冗余字段。
* **安全**: 增强账号安全性，Cookies数据采用加密存储。
* **编辑**: 重构逐帧获取界面，新增上一帧/下一帧、秒级跳转等精确控制功能。
* **分析**: 优化评论关键词提取算法，新增评论表情包分布图表。
* **UI**: 适配全屏显示模式，优化界面布局和交互体验。
* **核心**: 深度代码重构与性能优化，提升软件稳定性。

### v5.0

* **新增**: 暂停/取消下载时自动清理残留文件，保持磁盘整洁。
* **分析**: 优化弹幕颜色分布图表（改用条形图），移除标签云和表情包分析等冗余功能。
* **编辑**: 新增逐帧获取功能，支持查看并保存视频任意一帧，满足精确截图需求。
* **设置**: 新增超时时间和重试间隔设置，并优化所有设置选项的交互体验（鼠标悬停手势）。
* **UI**: 修复视频剪辑与压缩界面的按钮文字显示不全问题。
* **核心**: 代码深度重构，优化文件结构，提升代码可读性与维护性。

### v4.10

* **优化**: 移除热门视频获取时的冗余环境检查，提升响应速度。
* **分析**: 视频分析功能增强，新增视频标签云展示，优化IP属地解析准确性。
* **体验**: 全面优化按钮交互体验，统一鼠标悬停手势；实时观看窗口图标同步。
* **修复**: 修复悬浮窗在特定场景下的图片切换异常。
* **核心**: 代码深度重构与规范化，提升系统稳定性与维护性。

### v4.9

* **编辑**: 修复视频导入后名称不显示的问题。
* **分析**: 新增IP属地分布图表、标签显示、数据导出功能。
* **交互**: 悬浮窗新增随机休息动画和拖拽反馈。
* **功能**: 热门/收藏/历史列表右键新增"视频分析"入口。
* **体验**: 下载界面按钮鼠标手势优化。
* **核心**: 代码重构与优化。

### v4.8

* **番剧**: 新增下载历史查看（含状态、BV号等）；下载进度新增速度与集数显示。
* **分析**: 界面升级，新增评论用户等级分布、评论时间趋势图表；优化布局。
* **编辑**: 视频合并支持按帧截取，精度更高。
* **交互**: 新增桌面悬浮窗，实时显示下载进度与速度（可在设置中开启）。
* **核心**: 优化重试机制，确保设置生效；代码深度优化。

### v4.7

* **番剧**: 优化UI布局，按钮尺寸调整；新增清空下载历史功能；任务进度显示优化（动态显示视频/音频/合并进度）。
* **分析**: 界面全新升级，白色背景更清爽；图表与布局优化；新增视频分区显示。
* **播放**: 优化实时观看体验，支持自动网页全屏。
* **核心**: 代码深度优化与重构，清理冗余逻辑。

### v4.6

* **番剧**: 优化番剧下载目录结构，独立存放并按剧集分类；新增下载历史查看与目录打开功能。
* **分析**: 视频分析功能大幅增强，新增弹幕密度图表分析；优化空数据时的界面显示。
* **播放**: 优化实时播放功能，支持调用完整网页播放器以获得更高画质（需登录）。
* **UI**: 统一界面风格，优化设置页面背景；修复视频剪辑界面切换单位时的抖动问题。
* **核心**: 代码深度重构与优化，提升运行效率与稳定性。

### v4.5

* **功能**: 新增番剧下载功能，支持批量下载剧集。
* **功能**: 实时观看功能优化，支持更高画质（需登录）。
* **功能**: 视频分析功能增强，新增图表分析。
* **优化**: 修复取消下载时进度条不清空的Bug。
* **优化**: 修复视频剪辑界面UI错位Bug。

### v4.4

* **隐私**: 新增"隐私锁"功能，进入"我的账号"需点击解锁，更好保护隐私。
* **功能**: 热门视频、收藏夹、历史记录表格右键菜单新增"复制BV号"。
* **功能**: 历史记录表格新增右键菜单（下载、观看、复制BV号）。
* **观看**: 实时观看功能支持登录态，自动应用大会员画质（需在设置中登录）。
* **分析**: 视频分析Tab全新升级，新增封面预览、互动率图表，界面更美观。
* **架构**: 代码结构优化，提升稳定性。

### v4.3

* **核心**: 实时观看功能全面升级，引入HTML5播放器(WebView2)，解决浏览器不兼容问题。
* **新增**: 新增"视频分析"Tab，支持查看视频数据统计和评论词云分析。
* **增强**: 收藏夹导出Excel支持展示全部列字段。
* **优化**: 移除设置选项的阴影背景，视觉更清爽。
* **修复**: 修复导出收藏夹后弹窗报错的Bug。

### v4.2

* **核心**: 视频实时观看功能改用B站官方嵌入式播放器接口，实现纯净播放体验，支持原生弹幕与清晰度切换。
* **界面**: 优化主界面Tab样式，调整内边距与字体，防止文字截断；重新调整视频编辑界面布局比例，优化空间利用。
* **功能增强**: 热门视频与收藏夹列表新增封面悬停预览功能；收藏夹弹窗新增分页条数选择与数据导出功能（支持Excel/CSV）。
* **架构**: 重构日志系统，统一控制台与UI输出，移除冗余日志代码，提升可维护性。

### v4.1

* **精简**: 移除视频编辑中的"去除水印"工具页（保留设置中的自动去水印选项）。
* **精简**: 移除视频剪辑和压缩中的特效功能，移除视频合并中的转场特效。
* **新增**: 热门视频和收藏夹列表新增右键菜单，支持"下载视频"和"实时观看"。
* **新增**: "实时观看"功能，支持在独立弹窗中播放B站视频。
* **优化**: 优化工具类代码，移除无效冗余逻辑。
* **界面**: 菜单UI美化，更贴近B站风格。

### v4.0

* **日志**: 视频编辑功能新增详细日志输出，覆盖转换、剪辑、合并、去水印等操作，并在软件内系统日志和控制台同步显示。
* **体验**: 优化视频剪辑和去水印功能的交互体验，增加状态反馈和更清晰的指引。
* **下载**: 优化视频下载取消逻辑，取消后自动重置进度条和UI状态。
* **关于**: 新增"作者声明"页面，详细列出致谢名单和使用的开源技术。
* **文档**: 完善项目致谢文件 (credits.txt)。

### v3.10

* **界面**: 修复Tab名称显示不全的问题，优化视频编辑Tab交互体验，增加过渡动画。
* **修复**: 修复登录后选择低画质仍下载1080P的问题。
* **核心**: 重构去水印模块，支持更智能的区域检测；预留AI去水印接口。
* **优化**: 视频编辑功能去除冗余按钮，文件选择更便捷。
* **稳定性**: 修复若干已知问题，提升软件稳定性。

### v3.9

* **新增**: 界面缩放功能，完美适配1k/2k/4k等不同分辨率屏幕。
* **优化**: 所有下拉框禁止鼠标滚轮切换，防止误操作。
* **优化**: 视频编辑功能支持点击选择文件，去除冗余按钮。
* **核心**: 重构去水印模块，集成基础去水印算法。
* **稳定性**: 修复若干已知问题，提升软件稳定性。

### v3.8

* **新增**: 视频剪辑支持帧数模式，剪辑更精确。
* **新增**: 视频合并支持直接裁剪每个片段，无需预处理。
* **特效**: 剪辑、合并、压缩增加淡入淡出和转场动画支持。
* **界面**: 视频编辑页面UI全面美化，贴合B站风格，交互更流畅。
* **优化**: 视频合并流程优化，支持复杂的剪辑与转场组合。

### v3.7

* **新增**: 视频压缩功能，支持自定义分辨率和画质，轻松减小视频体积。
* **界面**: 视频编辑界面字体增大，提升阅读体验。
* **优化**: 采用更智能的去水印算法，效果更自然。
* **修复**: 修复了控制台日志输出异常的问题。
* **性能**: 优化了视频处理流程，更加稳定。

### v3.6

* **新增**: 视频编辑功能，集成格式转换、视频剪辑、视频合并、去水印。
* **界面**: 全新设计的视频编辑Tab，采用侧边导航，贴近B站风格。
* **优化**: 支持自定义区域去水印，更加灵活实用。
* **适配**: 优化了不同分辨率屏幕的适配效果。
* **核心**: 增强了错误处理和版本管理机制。

### v3.5

* **优化**: 下载失败时在系统日志中输出详细错误信息。
* **界面**: 设置界面字体放大，去除阴影，提升阅读体验。
* **智能**: 爬取时若无对应分辨率或编码，自动降级寻找最佳资源。
* **交互**: 支持点击头像跳转至B站个人主页。
* **核心**: 优化错误处理和版本信息管理。

### v3.4

* **新增**: 支持选择视频编码格式 (H.264/AVC, H.265/HEVC, AV1)。
* **新增**: 支持选择音频质量 (Hi-Res, 中等, 低)。
* **修复**: 修复大会员用户在特定情况下无法下载 4K/1080P+ 视频的问题。
* **优化**: 设置界面布局重构，更加美观易用。
* **核心**: 优化视频流选择算法，智能匹配最佳画质和编码。

### v3.3

* **体验**: 格式转换界面全新升级，增加过渡动画，优化字体大小。
* **日志**: 完善系统日志，覆盖视频转换、账号登录、设置保存等关键操作。
* **优化**: 简化下载日志输出，去除冗余信息。
* **重构**: 优化项目结构，提升代码内聚性。
* **修复**: 修复部分已知BUG。

### v3.2

* **优化**: 移除下载进度区域的冗余标题显示。
* **修复**: 修复视频格式转换功能的报错问题。
* **增强**: 系统日志全面覆盖，记录关键操作。
* **美化**: 优化格式转换界面布局和动画效果。
* **重构**: 优化代码结构，提升可维护性。

### v3.1

* **新增**: 视频格式转换功能，支持拖拽文件，支持mp4/mp3/gif等格式。
* **优化**: 设置界面布局调整，选项对齐更合理。
* **优化**: 账号界面增加过渡动画，信息排版更清晰。
* **修复**: 修复Windows任务栏图标不显示的问题。

### v3.0

* **重构**: "我的账号"界面全新设计，去除冗余元素，视觉更清爽。
* **优化**: 下载界面去除"正在下载"文本，专注于进度条展示。
* **增强**: 爬虫增加User-Agent轮询机制，提升防反爬能力。
* **修复**: 修复LOGO显示异常的问题。
* **增强**: 优化4K视频下载策略，修复偶发降级问题；增强去水印画质。

### v2.8

* **增强**: 支持查看收藏夹内部视频，双击即可跳转下载。。
* **优化**: 调整下载历史、热门视频等界面的布局和字体大小。
* **优化**: 优化布局，移除冗余边框，收藏夹列表增加ID显示。
* **优化**: 优化部分弹窗的显示效果。
* **升级**: 内核组件升级，提升稳定性。

### v2.7

* **修复**: 修复会员用户下载4K视频时画质被错误降级的问题。
* **优化**: 账号界面布局重构，提升空间利用率。
* **体验**: 增大设置保存弹窗，移除BV号提示弹窗的文字边框。
* **增强**: 去水印算法参数再优化，画质更细腻。
* **资源**: 添加图标生成提示词文件。

### v2.6

* **优化**: 账号界面优化，增大UID、等级等字体，调整表格样式。
* **升级**: 收藏夹列表将"创建时间"改为"状态"（公开/私密），更实用。
* **美化**: 重写下载失败弹窗，采用B站风格，统一视觉体验。
* **体验**: 系统日志字体进一步增大。
* **增强**: 去水印算法参数调优，画质更好。

### v2.5

* **优化**: 登录弹窗优化，简化提示信息，界面更清爽。
* **修复**: 修复了文件已存在时重复下载可能导致的报错问题。
* **美化**: 重写警告弹窗，采用圆角和主题色，统一B站风格。
* **体验**: 增大常用按钮字号，操作更便捷。
* **增强**: 优化去水印算法，自动适配更多分辨率，效果更自然。

### v2.4

* **修复**: 修复了打包过程中 `subprocess` 找不到文件的Bug。
* **UI**: 全局字体增大8px，提升阅读体验。
* **优化**: 登录弹窗移除遮挡二维码的文字组件，优化布局。
* **美化**: 界面细节进一步美化，增强B站风格（圆角、过渡动画）。
* **结构**: 项目结构清理与优化。

### v2.3

* **优化**: 优化下载进度条逻辑，不合并时自动隐藏合并进度条，界面更简洁。
* **体验**: 设置变更实时响应，勾选下载选项后立即在界面反馈。
* **UI**: 全局字体尺寸增大，提升高分辨率屏幕下的阅读体验。
* **美化**: 登录弹窗尺寸增大，布局优化，增强B站风格。
* **重构**: 代码结构优化，清理冗余代码，提升稳定性。

### v2.2

* **新增**: 视频下载界面动态显示评论、弹幕下载进度及合并进度。
* **新增**: 登录弹窗增加“保存账号信息”勾选框，支持自动登录或退出清除信息。
* **优化**: 登录按钮增加鼠标悬停手型交互，提升体验。
* **优化**: 智能去水印算法，根据分辨率自动适配水印位置和大小。
* **美化**: UI界面全面升级，增加过渡动画，贴近B站设计风格。
* **重构**: 优化项目结构，清理冗余代码。

### v2.1

* **界面**: 全新设计的登录弹窗，采用卡片式布局和B站主题色，更加美观。
* **优化**: 账号界面布局调整，移除旧版会员特权区域，扩大内容展示空间。
* **体验**: 增加界面过渡动画，提升交互流畅度。
* **功能**: 退出软件时自动清除登录信息，增强隐私保护。
* **细节**: 优化下载速度显示，精确保留两位小数。
* **提示**: 增大启动弹窗的字体，提升阅读体验。

### v2.0

* **重构**: 全面重构项目结构，功能模块化（DownloadTab, PopularTab, AccountTab, SettingsTab），提升代码可维护性和运行稳定性。
* **优化**: 登录弹窗二维码显示区域修复，确保正方形显示，修复`AttributeError` bug。
* **优化**: 移除界面冗余描述（如批量下载），更正会员特权描述。
* **优化**: 下载流程优化，进度条显示更加准确。
* **增强**: 独立打包脚本更新，支持一键生成免环境Windows可执行文件。

### v1.10

* **优化**: 登录弹窗二维码显示区域严格调整为正方形，修复变形bug。
* **优化**: 移除登录界面“保存登录状态”复选框，默认自动保存。
* **优化**: 重新设计设置界面布局，更加清晰美观。
* **优化**: 增强视频下载取消逻辑，确保资源释放和残留文件清理。
* **重构**: 优化项目结构，清理冗余代码。

### v1.9

* **优化**: 登录弹窗二维码显示区域调整为正方形，防止变形。
* **优化**: 视频下载取消逻辑，支持释放资源并删除残留文件。
* **优化**: 设置界面布局调整，移除冗余描述。
* **新增**: 登录用户可查看观看历史记录，并支持双击直接下载。
* **新增**: 应用程序图标支持。

### v1.8

* **修复**: 登录后分辨率选项不显示1080p及大会员4K选项的问题。
* **优化**: 调整登录弹窗大小，解决二维码缩小变形的问题。
* **优化**: 调整启动弹窗大小，提升阅读体验。
* **安全**: 新增退出软件时自动清除登录信息的功能。
* **优化**: 确保所有设置选项正确生效。

### v1.7

* **优化**: 设置界面布局重构，移除冗余选项。
* **新增**: 启动弹窗公告，显示版本更新内容。
* **新增**: 智能分辨率选择，根据登录状态和权益自动显示可用画质。
* **修复**: 收藏夹列表时间显示问题。
* **优化**: 移除了界面顶部的冗余标题栏。

### v1.6

* **新增**: 支持下载弹幕（XML/JSON）和评论（JSON）。
* **优化**: 控制台日志输出更加简洁直观。
* **修复**: 登录二维码生成失败的问题。
* **修复**: 部分视频去水印时可能出现的计算错误。
* **增强**: 完善了核心功能的单元测试覆盖。

### v1.5

* **新增**: 完整的去水印功能 (自动探测分辨率并应用delogo滤镜)。
* **优化**: 用户登录后自动下载最高画质 (4K/1080P+)。
* **修复**: 合并后删除原文件选项无效的问题。
* **修复**: 重新下载已存在视频时的报错问题。
* **重构**: 视频处理模块 (Processor) 独立并增强稳定性。
* **优化**: 设置选项实时生效，无需重启。

### v1.4

* **重构**: 核心代码模块化 (Network, API, Downloader, Processor)。
* **新增**: 实验性去水印功能。
* **优化**: UI响应速度和错误处理。
* **移除**: 废弃的搜索和用户信息查询功能。

### v1.3

* 移除搜索功能，精简界面。

## ⚠️ 免责声明

本项目仅供学习和个人使用，请勿用于商业用途或侵犯他人版权。下载的视频版权归原作者所有。
